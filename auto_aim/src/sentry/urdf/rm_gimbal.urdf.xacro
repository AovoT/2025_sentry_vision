<?xml version="1.0"?>

<robot name="rm_gimbal" xmlns:xacro="http://ros.org/wiki/xacro">
  <!-- 保留原有属性名 -->
  <xacro:property name="xyz" default="0 0 0"/>
  <xacro:property name="rpy" default="0 0 0"/>

  <!-- 根链接和大云台 -->
  <link name="odom"/>

  <link name="gimbal_big_link"/>

  <joint name="gimbal_joint" type="fixed">
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <parent link="odom"/>
    <child link="gimbal_big_link"/>
  </joint>

  <!-- 左云台：增加固定偏移层 -->
  <link name="gimbal_left_link_offset"/>

  <joint name="gimbal_left_offset_joint" type="fixed">
    <origin xyz="0 0.2 0.1" rpy="0 0 0"/>
    <parent link="gimbal_big_link"/>
    <child link="gimbal_left_link_offset"/>
  </joint>

  <link name="gimbal_left_link"/>

  <joint name="gimbal_big_to_gimbal_left_joint" type="continuous">
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <parent link="gimbal_left_link_offset"/>
    <child link="gimbal_left_link"/>
    <axis xyz="0 0 1"/>
  </joint>

  <!-- 右云台：增加固定偏移层 -->
  <link name="gimbal_right_link_offset"/>
  <joint name="gimbal_right_offset_joint" type="fixed">
    <origin xyz="0 -0.2 0.1" rpy="0 0 0"/>
    <parent link="gimbal_big_link"/>
    <child link="gimbal_right_link_offset"/>
  </joint>
  <link name="gimbal_right_link"/>
  <joint name="gimbal_big_to_gimbal_right_joint" type="continuous">
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <parent link="gimbal_right_link_offset"/>
    <child link="gimbal_right_link"/>
    <axis xyz="0 0 1"/>
  </joint>

  <!-- 摄像机挂载宏：简化重复 -->
  <xacro:macro name="camera_chain" params="parent_link camera_link_name camera_joint_name optical_frame_name optical_joint_name">
    <link name="${camera_link_name}"/>
    <joint name="${camera_joint_name}" type="fixed">
      <origin xyz="${xyz}" rpy="${rpy}"/>
      <parent link="${parent_link}"/>
      <child link="${camera_link_name}"/>
      <axis xyz="0 0 0"/>
    </joint>
    <link name="${optical_frame_name}"/>
    <joint name="${optical_joint_name}" type="fixed">
      <origin xyz="0 0 0" rpy="-1.5708 0 -1.5708"/>
      <parent link="${camera_link_name}"/>
      <child link="${optical_frame_name}"/>
    </joint>
  </xacro:macro>

  <!-- 左右摄像机链 -->
  <xacro:camera_chain parent_link="gimbal_left_link" camera_link_name="left_camera_link" camera_joint_name="left_camera_joint" optical_frame_name="left_camera_optical_frame" optical_joint_name="left_camera_optical_joint"/>
  <xacro:camera_chain parent_link="gimbal_right_link" camera_link_name="right_camera_link" camera_joint_name="right_camera_joint" optical_frame_name="right_camera_optical_frame" optical_joint_name="right_camera_optical_joint"/>

</robot>
